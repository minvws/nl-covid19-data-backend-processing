CREATE   PROCEDURE [dbo].[SP_RIVM_COVID_19_CASE_NATIONAL_ARCHIVE_INTER_DATASET] (@Date_Last_Inserted as DateTime)
AS
BEGIN

BEGIN TRANSACTION;
 
    INSERT INTO VWSARCHIVE.RIVM_COVID_19_CASE_NATIONAL_ARCHIVE_INTER
        (DATE_FILE, 
        DATE_STATISTICS, 
        DATE_STATISTICS_TYPE, 
        AGEGROUP, 
        SEX, 
        PROVINCE, 
        HOSPITAL_ADMISSION, 
        DECEASED, 
        WEEK_OF_DEATH, 
        MUNICIPAL_HEALTH_SERVICE, 
        DATE_LAST_INSERTED)
     SELECT
        DATE_FILE,
        DATE_STATISTICS,
        DATE_STATISTICS_TYPE,
        AGEGROUP,
        SEX,
        PROVINCE,
        HOSPITAL_ADMISSION,
        DECEASED,
        WEEK_OF_DEATH,
        MUNICIPAL_HEALTH_SERVICE,
        DATE_LAST_INSERTED
    FROM VWSINTER.RIVM_COVID_19_CASE_NATIONAL
	WHERE DATE_LAST_INSERTED = @Date_Last_Inserted;

	DELETE FROM VWSINTER.RIVM_COVID_19_CASE_NATIONAL
	WHERE DATE_LAST_INSERTED = @Date_Last_Inserted;

COMMIT;

END